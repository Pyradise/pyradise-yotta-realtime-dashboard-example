<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Pyradise Realtime Dashboard Example</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="vendors/iconfonts/mdi/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="vendors/css/vendor.bundle.base.css">
  <link rel="stylesheet" href="vendors/css/vendor.bundle.addons.css">
  <!-- endinject -->
  <!-- plugin css for this page -->
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="css/style.css">
  <!-- endinject -->
  <link rel="shortcut icon" href="images/favicon.png" />

</head>

<body>
  <div class="container-scroller">
    <!-- partial:partials/_navbar.html -->
    <nav class="navbar default-layout col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
      <div class="text-center navbar-brand-wrapper d-flex align-items-top justify-content-center">
        <a class="navbar-brand brand-logo" href="index.html">
          <img src="images/logo.svg" alt="logo" />
        </a>
        <a class="navbar-brand brand-logo-mini" href="index.html">
          <img src="images/logo-mini.svg" alt="logo" />
        </a>
      </div>
      <div class="navbar-menu-wrapper d-flex align-items-center">
        <ul class="navbar-nav navbar-nav-left header-links d-none d-md-flex">
          <li class="nav-item">
            <a href="#" class="nav-link">Schedule
              <span class="badge badge-primary ml-1">New</span>
            </a>
          </li>
          <li class="nav-item active">
            <a href="#" class="nav-link">
              <i class="mdi mdi-elevation-rise"></i>Reports</a>
          </li>

        </ul>
        <ul class="navbar-nav navbar-nav-right">
          <li class="nav-item dropdown">
            <a class="nav-link count-indicator dropdown-toggle" id="messageDropdown" href="#" data-toggle="dropdown"
              aria-expanded="false">
              <i class="mdi mdi-file-document-box"></i>
              <span class="count">7</span>
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="messageDropdown">
              <div class="dropdown-item">
                <p class="mb-0 font-weight-normal float-left">You have 7 unread mails
                </p>
                <span class="badge badge-info badge-pill float-right">View all</span>
              </div>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <img src="images/faces/face4.jpg" alt="image" class="profile-pic">
                </div>
                <div class="preview-item-content flex-grow">
                  <h6 class="preview-subject ellipsis font-weight-medium text-dark">David Grey
                    <span class="float-right font-weight-light small-text">1 Minutes ago</span>
                  </h6>
                  <p class="font-weight-light small-text">
                    The meeting is cancelled
                  </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <img src="images/faces/face2.jpg" alt="image" class="profile-pic">
                </div>
                <div class="preview-item-content flex-grow">
                  <h6 class="preview-subject ellipsis font-weight-medium text-dark">Tim Cook
                    <span class="float-right font-weight-light small-text">15 Minutes ago</span>
                  </h6>
                  <p class="font-weight-light small-text">
                    New product launch
                  </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <img src="images/faces/face3.jpg" alt="image" class="profile-pic">
                </div>
                <div class="preview-item-content flex-grow">
                  <h6 class="preview-subject ellipsis font-weight-medium text-dark"> Johnson
                    <span class="float-right font-weight-light small-text">18 Minutes ago</span>
                  </h6>
                  <p class="font-weight-light small-text">
                    Upcoming board meeting
                  </p>
                </div>
              </a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link count-indicator dropdown-toggle" id="notificationDropdown" href="#" data-toggle="dropdown">
              <i class="mdi mdi-bell"></i>
              <span class="count">4</span>
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
              <a class="dropdown-item">
                <p class="mb-0 font-weight-normal float-left">You have 4 new notifications
                </p>
                <span class="badge badge-pill badge-warning float-right">View all</span>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-success">
                    <i class="mdi mdi-alert-circle-outline mx-0"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <h6 class="preview-subject font-weight-medium text-dark">Application Error</h6>
                  <p class="font-weight-light small-text">
                    Just now
                  </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-warning">
                    <i class="mdi mdi-comment-text-outline mx-0"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <h6 class="preview-subject font-weight-medium text-dark">Settings</h6>
                  <p class="font-weight-light small-text">
                    Private message
                  </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-info">
                    <i class="mdi mdi-email-outline mx-0"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <h6 class="preview-subject font-weight-medium text-dark">New user registration</h6>
                  <p class="font-weight-light small-text">
                    2 days ago
                  </p>
                </div>
              </a>
            </div>
          </li>
          <li class="nav-item dropdown d-none d-xl-inline-block">
            <a class="nav-link dropdown-toggle" id="UserDropdown" href="#" data-toggle="dropdown" aria-expanded="false">
              <span class="profile-text">Hello, 帽子哥 !</span>
              <img class="img-xs rounded-circle" src="images/faces/resnick.jpg" alt="Profile image">
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown" aria-labelledby="UserDropdown">
              <a class="dropdown-item p-0">
                <div class="d-flex border-bottom">
                  <div class="py-3 px-4 d-flex align-items-center justify-content-center">
                    <i class="mdi mdi-bookmark-plus-outline mr-0 text-gray"></i>
                  </div>
                  <div class="py-3 px-4 d-flex align-items-center justify-content-center border-left border-right">
                    <i class="mdi mdi-account-outline mr-0 text-gray"></i>
                  </div>
                  <div class="py-3 px-4 d-flex align-items-center justify-content-center">
                    <i class="mdi mdi-alarm-check mr-0 text-gray"></i>
                  </div>
                </div>
              </a>
              <a class="dropdown-item mt-2">
                Manage Accounts
              </a>
              <a class="dropdown-item">
                Change Password
              </a>
              <a class="dropdown-item">
                Check Inbox
              </a>
              <a class="dropdown-item">
                Sign Out
              </a>
            </div>
          </li>
        </ul>
        <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
          <span class="mdi mdi-menu"></span>
        </button>
      </div>
    </nav>
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <!-- partial:partials/_sidebar.html -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
          <li class="nav-item nav-profile">
            <div class="nav-link">
              <div class="user-wrapper">
                <div class="profile-image">
                  <img src="images/faces/resnick.jpg" alt="profile image">
                </div>
                <div class="text-wrapper">
                  <p class="profile-name">帽子哥</p>
                  <div>
                    <small class="designation text-muted">Manager</small>
                    <span class="status-indicator online"></span>
                  </div>
                </div>
              </div>
              <button class="btn btn-success btn-block">New Project
                <i class="mdi mdi-plus"></i>
              </button>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html">
              <i class="menu-icon mdi mdi-television"></i>
              <span class="menu-title">Dashboard</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="menu-icon mdi mdi-chart-line"></i>
              <span class="menu-title">Charts</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="menu-icon mdi mdi-table"></i>
              <span class="menu-title">Positions</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="menu-icon mdi mdi-table"></i>
              <span class="menu-title">Portfolio Planning</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="menu-icon mdi mdi-chart-line"></i>
              <span class="menu-title">Balances</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="menu-icon mdi mdi-chart-line"></i>
              <span class="menu-title">Gain/Loss</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="menu-icon mdi mdi-table"></i>
              <span class="menu-title">Watch List</span>
            </a>
          </li>

        </ul>
      </nav>
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">
              <div class="card card-statistics">
                <div class="card-body">
                  <div class="clearfix">
                    <div class="float-left">
                      <i id="nasdaq-arrow" class="mdi mdi-arrow-down text-danger icon-lg"></i>
                    </div>
                    <div class="float-right">
                      <p class="mb-0 text-right">NASDAQ</p>
                      <div class="fluid-container">
                        <h3 class="font-weight-medium text-right mb-0"><span id="nasdaq-value">7902.54</span></h3>
                      </div>
                    </div>
                  </div>
                  <p class="text-muted mt-3 mb-0">
                    <i class="mdi mdi-reload mr-1" aria-hidden="true"></i> <span id="nasdaq-chg">0</span> (<span id="nasdaq-chg-p">0.0</span>%)
                  </p>
                </div>
                <div id="nasdaq-sparkline"></div>
              </div>

            </div>
            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">
              <div class="card card-statistics">
                <div class="card-body">
                  <div class="clearfix">
                    <div class="float-left">
                      <i id="sp500-arrow" class="mdi mdi-arrow-down text-danger icon-lg"></i>
                    </div>
                    <div class="float-right">
                      <p class="mb-0 text-right">S&P 500</p>
                      <div class="fluid-container">
                        <h3 class="font-weight-medium text-right mb-0"><span id="sp500-value">2871.68</span></h3>
                      </div>
                    </div>
                  </div>
                  <p class="text-muted mt-3 mb-0">
                    <i class="mdi mdi-reload mr-1" aria-hidden="true"></i> <span id="sp500-chg">0</span> (<span id="sp500-chg-p">0.0</span>%)
                  </p>
                </div>
                <div id="sp500-sparkline"></div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">
              <div class="card card-statistics">
                <div class="card-body">
                  <div class="clearfix">
                    <div class="float-left">
                      <i id="russell3000-arrow" class="mdi mdi-arrow-down text-danger icon-lg"></i>
                    </div>
                    <div class="float-right">
                      <p class="mb-0 text-right">Russell 3000</p>
                      <div class="fluid-container">
                        <h3 class="font-weight-medium text-right mb-0"><span id="russell3000-value">1706.99</span> </h3>
                      </div>
                    </div>
                  </div>
                  <p class="text-muted mt-3 mb-0">
                    <i class="mdi mdi-reload mr-1" aria-hidden="true"></i> <span id="russell3000-chg">0</span> (<span
                      id="russell3000-chg-p">0.0</span>%)
                  </p>
                </div>
                <div id="russell3000-sparkline"></div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">
              <div class="card card-statistics">
                <div class="card-body">
                  <div class="clearfix">
                    <div class="float-left">
                      <i id="djia-arrow" class="mdi mdi-arrow-down text-danger icon-lg"></i>
                    </div>
                    <div class="float-right">
                      <p class="mb-0 text-right">DJIA</p>
                      <div class="fluid-container">
                        <h3 class="font-weight-medium text-right mb-0"><span id="djia-value">25916.54</span> </h3>
                      </div>
                    </div>
                  </div>
                  <p class="text-muted mt-3 mb-0">
                    <i class="mdi mdi-reload mr-1" aria-hidden="true"></i> <span id="djia-chg">0</span> (<span id="djia-chg-p">0.0</span>%)
                  </p>
                </div>
                <div id="djia-sparkline"></div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12 grid-margin">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Apple Stock Candlestick Chart</h4>
                  <div id="chart-container">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-12 grid-margin">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Nasdaq Stock Market</h4>
                  <div class="table-responsive">
                    <table class="table table-bordered">
                      <thead>
                        <tr>
                          <th>
                            #
                          </th>
                          <th>
                            Name
                          </th>
                          <th>
                            Symbol
                          </th>
                          <th>
                            Open
                          </th>
                          <th>
                            High
                          </th>
                          <th>
                            Low
                          </th>
                          <th>
                            Close
                          </th>
                          <th>
                            %Chg
                          </th>
                        </tr>
                      </thead>
                      <tbody id="stock-market-data">

                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
        <!-- content-wrapper ends -->
        <!-- partial:partials/_footer.html -->
        <footer class="footer">
          <div class="container-fluid clearfix">
            <span class="text-muted d-block text-center text-sm-left d-sm-inline-block">Copyright © 2018
              <a href="http://www.bootstrapdash.com/" target="_blank">Bootstrapdash</a>. All rights reserved.</span>
            <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">Hand-crafted & made with
              <i class="mdi mdi-heart text-danger"></i>
            </span>
          </div>
        </footer>
        <!-- partial -->
      </div>
      <!-- main-panel ends -->
    </div>
    <!-- page-body-wrapper ends -->
  </div>
  <!-- container-scroller -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
  <!-- plugins:js -->
  <script src="vendors/js/vendor.bundle.base.js"></script>
  <script src="vendors/js/vendor.bundle.addons.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page-->
  <!-- End plugin js for this page-->
  <!-- inject:js -->
  <script src="js/off-canvas.js"></script>
  <script src="js/misc.js"></script>
  <!-- endinject -->
  <!-- Custom js for this page-->
  <script src="js/dashboard.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.4.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.4.2/firebase-firestore.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.1.2/jquery.sparkline.min.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyBXnE7M3vkiIZOKAiUyPowrrdGbXVzsnI4",
      authDomain: "pyradise-yotta.firebaseapp.com",
      databaseURL: "https://pyradise-yotta.firebaseio.com",
      projectId: "pyradise-yotta",
      storageBucket: "pyradise-yotta.appspot.com",
      messagingSenderId: "1083364153432"
    };
    firebase.initializeApp(config);
    db = firebase.firestore();
  </script>
  <script>
    function Trace(increasingColor, decreasingColor, lineColor, xaxis, yaxis) {
      this.x = [];
      this.open = [];
      this.high = [];
      this.low = [];
      this.close = [];
      this.increasing = {
        line: {
          color: increasingColor
        }
      };
      this.decreasing = {
        line: {
          color: decreasingColor
        }
      };
      this.line = {
        color: lineColor
      };
      this.type = 'candlestick';
      this.xaxis = xaxis;
      this.yaxis = yaxis;
    }

    var increasingColor = '#00ce68';
    var decreasingColor = '#e65251';
    var lineColor = 'rgba(31,119,180,1)';
    var xaxis = 'x';
    var yaxis = 'y';

    var trace = new Trace(increasingColor, decreasingColor, lineColor, xaxis, yaxis);

    var traces = [trace];

    var layout = {
      dragmode: "zoom",
      margin: {
        t: 25,
        r: 10,
        b: 40,
        l: 30
      },
      showlegend: false,
      xaxis: {
        domain: [0, 1],
        autorange: true,
        range: ['2018-08-01', '2019-7-31'],
        rangeslider: {
          range: ['2018-08-01', '2019-7-31']
        },
        type: 'date'
      },
      yaxis: {
        outrange: true,
        domain: [0, 1],
        range: [205, 240],
        type: 'linear'
      }
    };

    Plotly.plot('chart-container', traces, layout);

    var collectionRef = db.collection('stocks/APPL/datas');

    collectionRef.onSnapshot(function (snapshot) {
      snapshot.forEach(function (doc) {
        var ohlc = doc.data();

      });
    });


    var sparklineOption = {
      type: 'line',
      width: '100%',
      height: '100%',
      lineColor: '#2965a5',
      fillColor: '#dbe9fc',
      lineWidth: 2
    };

    var sparklineData = {
      "nasdaq": {
        open: 7902.54,
        points: [7902.54]
      },
      "sp500": {
        open: 2871.68,
        points: [2871.68]
      },
      "russell3000": {
        open: 1706.99,
        points: [1706.99]
      },
      "djia": {
        open: 25916.54,
        points: [25916.54]
      }
    };

    var tableData = [{
      name: "Apple",
      symbol: "AAPL",
      open: 221.85,
      high: 225.37,
      low: 220.71,
      close: 221.30,
      points: [221.85]
    }, {
      name: "Alphabet Cl A",
      symbol: "GOOGL",
      open: 1172.00,
      high: 1188.55,
      low: 1169.27,
      close: 1177.59,
      points: [1172.00]
    }, {
      name: "Alphabet Cl C",
      symbol: "GOOG",
      open: 1158.67,
      high: 1175.26,
      low: 1157.21,
      close: 1164.83,
      points: [1158.67]
    }, {
      name: "Microsoft",
      symbol: "MSFT",
      open: 108.23,
      high: 108.72,
      low: 107.23,
      close: 107.23,
      points: [108.23]
    }, {
      name: "Amazon.com",
      symbol: "AMZN",
      open: 1938.71,
      high: 1975.20,
      low: 1937.35,
      close: 1952.07,
      points: [1938.71]
    }, {
      name: "Facebook Cl A",
      symbol: "FB",
      open: 160.31,
      high: 164.63,
      low: 160.16,
      close: 163.04,
      points: [160.31]
    }];

    function renderTable() {
      $("#stock-market-data").html("");
      for (var index = 0; index < tableData.length; index++) {
        var chgp = ((tableData[index].close - tableData[index].open) / tableData[index].open).toFixed(4) * 100;
        var tr =
          `<tr>
    <td class="font-weight-medium">
      ${index+1}
    </td>
    <td>
        ${tableData[index].name} <span id="${tableData[index].symbol}-sparkline"></span>
    </td>
    <td>
        ${tableData[index].symbol}
    </td>
    <td>
        ${tableData[index].open.toFixed(2)}
    </td>
    <td>
        ${tableData[index].high.toFixed(2)}
    </td>
    <td>
        ${tableData[index].low.toFixed(2)}
    </td>
    <td>
        ${tableData[index].close.toFixed(2)}
    </td>
    <td class="text-${chgp < 0? "danger":"success"}"> ${chgp.toFixed(2)}%
      <i class="mdi mdi-arrow-${chgp < 0? "down":"up"}"></i>
    </td>
  </tr>`
        $(tr).appendTo($("#stock-market-data"));

        if (tableData[index].points.length == 15)
          tableData[index].points.shift();
        $(`#${tableData[index].symbol}-sparkline`).sparkline(tableData[index].points, {
          type: 'line',
          lineColor: '#2965a5',
          fillColor: '#dbe9fc',
          lineWidth: 2
        });
      }


    }

    function randomFloat(min, max) {
      return (max - min) * Math.random() + min;
    }
    renderTable();
    var startDate = moment("2018-08-01 00:00:00", "YYYY-MM-DD hh:mm:ss");
    var minutes = 0;
    setInterval(function () {
      Object.keys(sparklineData).forEach(function (key) {
        if (sparklineData[key].points.length == 15)
          sparklineData[key].points.shift();
        var open = sparklineData[key].open;
        var value = open + Math.random() * open * .01 * (Math.random() > 0.5 ? 2 : -
          1);
        sparklineData[key].points.push(value);
        $(`#${key}-sparkline`).sparkline(
          sparklineData[key].points, sparklineOption);
        $(`#${key}-value`).text(value.toFixed(2));
        $(`#${key}-chg`).text((value - open).toFixed(2));
        $(`#${key}-chg-p`).text(((value - open) / open * 100).toFixed(2));
        if (value - open > 0) {
          $(`#${key}-arrow`).removeClass("mdi-arrow-down text-danger");
          $(`#${key}-arrow`).addClass("mdi-arrow-up text-success");
        } else {
          $(`#${key}-arrow`).removeClass("mdi-arrow-up text-success");
          $(`#${key}-arrow`).addClass("mdi-arrow-down text-danger");
        }
      });

      for (var index = 0; index < tableData.length; index++) {

        tableData[index].open += Math.random() * tableData[index].points[0] * 0.002 * (Math.random() > 0.5 ? 1 : -1);
        tableData[index].high = tableData[index].open * randomFloat(1.01, 1.02);
        tableData[index].low = tableData[index].open * randomFloat(0.97, 1.0);
        tableData[index].close = tableData[index].open * randomFloat(0.97, 1.02);
        if (tableData[index].close > tableData[index].high)
          tableData[index].close = tableData[index].high;
        if (tableData[index].close < tableData[index].low)
          tableData[index].close = tableData[index].low;
        if (tableData[index].points.length == 15)
          tableData[index].points.shift();
        tableData[index].points.push(tableData[index].open);
      }

      renderTable();
      var ohlc = tableData[0];
      ohlc.date = startDate.add(1, "day").format("YYYY-MM-DD hh:mm:ss");
      Plotly.extendTraces('chart-container', {
        x: [
          [ohlc.date]
        ],
        open: [
          [ohlc.open]
        ],
        high: [
          [ohlc.high]
        ],
        low: [
          [ohlc.low]
        ],
        close: [
          [ohlc.close]
        ]
      }, [0]);

    }, 700);
  </script>
  <!-- End custom js for this page-->
</body>

</html>